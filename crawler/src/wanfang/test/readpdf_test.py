# coding=utf-8
# date:下午4:06 
# author:chenjunbiao
import re
import unittest

from crawler.src.wanfang.readpdf import PaperDoc, spilt_reference, Mysql, get_ref_txt


# import PaperDoc


class TestPaperDoc(unittest.TestCase):
    def test_reg_split(self):
        self.skipTest('skip')
        # s = u'jhhj....frf'
        # l = re.compile('(\\.+)').split(s)
        s1 = u'jhhj....frf[2]78'
        l = re.compile('(\\[[1-9][0-9]*\\])').split(s1)
        # l = re.compile('^(\\.+)').split(s)
        print l

    def test_dd(self):
        self.skipTest('skip')
        paper_doc = PaperDoc.create_paper_doc()
        # paper_doc.catalogtxt = "目    录 \
        #       中文摘要 .......................................................................................................................................... I \
        #       Abstract ........................................................................................................................................... II \
        #       目    录 ............................................................................................................................................ III \
        #       第一章  绪论 ................................................................................................................................... 1 \
        #       1.1 选题缘由 .................................................................................................................................. 1 \
        #       1.2 研究现状 .................................................................................................................................. 2 \
        #       1.3 研究目的及意义 ...................................................................................................................... 8 \
        #       第二章  惯用语的选择及语义透明度等级划分 ......................................................................... 10 \
        #       2.1 惯用语的选择 ........................................................................................................................ 10 \
        #       2.2 惯用语语义透明度界定与等级评定 .................................................................................... 11 \
        #       第三章  留学生汉语惯用语理解问卷调查及分析 ..................................................................... 14 \
        #       3.1 研究方法与过程 .................................................................................................................... 14 \
        #       3.2 透明度对留学生汉语惯用语理解的影响 ............................................................................ 16 \
        #       3.3 华裔与非华裔对汉语惯用语理解的差异 ............................................................................ 23 \
        #       3.4 本章小结 ................................................................................................................................ 26 \
        #       第四章  留学生汉语惯用语释义误选情况分析 ......................................................................... 28 \
        #       4.1 调查问卷选项设置依据 ........................................................................................................ 28 \
        #       4.2 留学生汉语惯用语释义误选情况分析 ................................................................................ 31 \
        #       4.3 本章小结 ................................................................................................................................ 42 \
        #       第五章  对中高级水平留学生汉语惯用语教学的建议 ............................................................. 45 \
        #       5.1 汉语惯用语选择基本原则 .................................................................................................... 45 \
        #       5.2 透明度对对外汉语惯用语教学的启示 ................................................................................ 46 \
        #       5.3 根据误选情况分析对教学方法的建议 ................................................................................ 49 \
        #       第六章  结语 ................................................................................................................................. 54 \
        #       注  释 ............................................................................................................................................. 56 \
        #       参考文献 ....................................................................................................................................... 57 \
        #       附  录 ............................................................................................................................................. 60 \
        #       后  记 ............................................................................................................................................. 71 \
        #       III"

        # self.skipTest('skip')
        paper_doc.analyze_catalog()
        self.assertEqual(1, 1)

    def test_extract_reference(self):
        self.skipTest('skip')
        path = '/Users/chenjunbiao/project/graduation_project/data/《中文·教学参考》（小学版）编写体例及内容研究.pdf'
        paper_doc = PaperDoc.create_paper_doc(path)
        reference_items = paper_doc.extract_reference()
        mysql = Mysql()
        mysql.connect()
        for item in reference_items:
            try:
                reference_dic = spilt_reference(item)
                sql = "INSERT INTO reference(paper_title, \
                                  author, reference_title, type, getted) \
                                  VALUES ('%s', '%s', '%s', '%s', '%d' )" % \
                      (paper_doc.title, reference_dic['author'].encode('utf-8'),
                       reference_dic['reference_title'].encode('utf-8'),
                       reference_dic['reference_type'].encode('utf-8'), 0)
                # sql.format(paper_doc.title, reference_dic['author'], reference_dic['reference_title'],
                #            reference_dic['reference_type'])
                mysql.insert(sql)
            except:
                print reference_dic

    def test_sql(self):
        self.skipTest('skip')
        sql = "INSERT INTO reference(paper_title, \
               author, reference_title, type, getted) \
               VALUES ('%s', '%s', '%s', '%s', '%d' )" % \
              (u'没开门', "^", "0", "ff", 0)
        print sql

    def test_find_catalog(self):
        self.skipTest('skip')
        catalog_exp = u'(目录)|(目\s+录)'
        print re.findall(catalog_exp, u'kfk目录jf')

    def test_ref_txt(self):
        # self.skipTest('skip')
        get_ref_txt()

